# `스코프 함수`
스코프 함수(Scope Function)는 코드를 축약해서 표현할 수 있도록 도와주는 함수이다.

영역 함수라고도 하며,
사용법은 함수처럼 쓰지 않고 run, let처럼 괄호 없이 일종의 키워드 같이 사용할 수 있다.

lateinit과 함께 Safe Call 남용을 막아주는 역할도 하기 때문에 많이 사용하는 요소이다.

- ## `run과 let으로 보는 스코프 함수`
run과 let은 자신의 함수 스코프(코드 블록) 안에서 호출한 대상을  this와 it로 대체해서 사용할 수 있다.
- ### run 
스코프 함수 안에서 호출한 대상을 this로 사용할 수 있다.

```kotlin
var list = mutableListOf("Scope", "Function")
list.run {
    val listSize = size
    println("list의 길이 run = $listSize")
}
```

클래스 내부의 함수를 사용하는 것과 동일한 효과이기 때문에  this는 생략하고 메서드나 프로퍼티를 바로 사용할 수 있다.

- ### let
함수 영역 안에서 호출한 대상을 it으로 사용할 수 있습니다.
```kotlin
var list = mutableListOf("Scope", "Function")
list.let { // it -> 생략된 형태. it -> 대신에 target -> 등으로 변경 가능합니다.
    val listSize = it.size // 모든 속성과 함수를 it.멤버로 사용할 수 있습니다.
    println("리스트의 길이 let = $listSize")
}
```
it을 생략할 수는 없지만 target 등 다른 이름으로 바꿀 수 있다.

- ### this로 사용되는 스코프 함수: run, apply, with
다음은 apply와 with의 사용 예제이다. 스코프 함수 안에서 this로 사용되기 때문에 메서드나 프로퍼티를 직접 호출한다.

```kotlin
var list = mutableListOf("Scope", "Function")

list.apply {
    val listSize = size
    println("리스트의 길이 apply = $listSize")
}

with (list){
    val listSize = size
    println("리스트의 길이 with = $listSize")
}
```

- 호출 대상이 null일 경우 
with는 스코프 함수이긴 하지만 위의 2개와는 다르게 확장(Extension) 함수가 아니기 때문에 일반 함수처럼 사용한다.
따라서 호출하는 대상이 null일 경우에는 with보다는 apply나 run을 사용하는 것이 효율적이다.
```kotlin
target?.apply { /* 코드 */ }
```
- ### it으로 사용되는 스코프 함수:let,also
```kotlin
var list = mutableListOf("Scope", "Function")
list.let { target -> // it을 target 등과 같이 다른 이름으로 변경 가능합니다.
    val listSize = target.size // target으로 변경했기에 멤버 접근은 target.속성 입니다.
    println("리스트의 길이 let = $listSize")
}

list.also {
    val listSize = it.size
    println("리스트의 길이 also = $listSize")
}
```
- ## `반환값으로 구분하기`
동일하게 this로 사용되는 함수라도 대입 연산자를 사용해서 값을 반환할 경우에는 용도가 달라진다.

결괏값을 반환할 경우, 스코프가 종료되는 시점에서의 반환값이 다르기 때문에 서로 다른 역할을 하는 스코프 함수가 필요하다.

- ### 호출 대상인 this 자체를 반환하는 스코프 함수: apply, also

